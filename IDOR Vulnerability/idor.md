# 3.IDOR

مراحل ابتدیی

1 .  اگر امکانش وجود داره 2 حساب کاربری بسازید و در غیر این صورت user enumerate کنید

2 .  اول endpoint هارو چک کنید ببینید پرایویت یا پابلیک هست و یا شامل هرگونه پارامتر id هست

3 .  مقدار پارامتر هارو به کاربرای دیگه ای تغییر بدید و ببینید چیزی برای حساب کاربری اونها انجام میشود

4 .  تمام شد !!

عکس پروفایل - حذف حساب کاربری - اطلاعات حساب - نمایش و حذف و ایجاد api_key - اجازه خواندن نظراتی که نباید در دید کاربران عادی باشند و به صورت خصوصی ارسال شدن - تغییر دادن قیمت - تغییر ارز برای مثال از دلار به یورو - اگر id انکد (encode) شده بود برای مثال با base64 یا md5 و… برای دیکدش (decode) تلاش کنید

```
GET /GetUser/dmljdGltQG1haWwuY29t
[...]
```

HTTP method تغییر بدید

```
GET /users/delete/victim_id  -> 403
POST /users/delete/victim_id -> 200
```

اسم پارامتر هارو سعی کنید جایگزین کنید

```
به جای این
GET /api/albums?album_id=<album id>

این رو امتحان کنید
GET /api/albums?account_id=<account id>
```

نکته: یک اکستنشن برپ سوییت به نام Paramalyzer وجود داره که کمک میکنه به بخاطر سپردن تمام پارامتر هایی که به یک هاست ارسال کردید 

Path Traversal

```
POST /users/delete/victim_id          -> 403
POST /users/delete/my_id/..victim_id  -> 200
```

content-type ریکوئست رو تغییر بدید

```
Content-Type: application/xml  -> 403
Content-Type: application/json -> 200
```

اگر id عدد نبود سعی کنید با عدد جایگزین کنید

```
GET /file?id=90djbkdbkdbd29dd
GET /file?id=302
```

Missing Function Level Access Control

```
GET /admin/profile ->401
GET /Admin/profile ->200
GET /ADMIN/profile ->200
GET /aDmin/profile ->200
GET /adMin/profile ->200
GET /admIn/profile ->200
GET /admiN/profile ->200
```

به جای id میتونیم wildcard ارسال کنیم

```
GET /api/users/user_id
GET /api/users/*
```

هرگز id هایی که هش/رمزگزاری (encoded/hashed) شدند رو نادیده نگیرید

برای id هش شده چندین حساب کاربری بسازید و الگوی اختصاص id به کاربرای اپلیکیشن رو بفهمید

Google Dorking/public form

همه endpoint هایی که id دارن سرچ کنید که ممکن هست موتور جست و جو قبلا ایندکس کرده باشه

Bruteforce Hidden HTTP parameters

از ابزارهایی مانند arjun، paraminer استفاده کنید

Bypass object level authorization

پارامتر رو به endpoint اضافه کنید اگر به صورت پیش فرض وجود نداره

```
GET /api_v1/messages ->200
GET /api_v1/messages?user_id=victim_uuid ->200
```

HTTP Parameter Pollution

چند بار اون پارامتر با مقدار های متفاوت بهش بدید

```
GET /api_v1/messages?user_id=attacker_id&user_id=victim_id
GET /api_v1/messages?user_id=victim_id&user_id=attacker_id
```

file type رو تغییر بدید

```
GET /user_data/2341        -> 401
GET /user_data/2341.json   -> 200
GET /user_data/2341.xml    -> 200
GET /user_data/2341.config -> 200
GET /user_data/2341.txt    -> 200
```

json parameter pollution

```
{"userid":1234,"userid":2542}
```

id رو داخل یک ارایه بزارید

```
{"userid":123} ->401
{"userid":[123]} ->200
```

id رو داخل یک json object بزارید

```
{"userid":123} ->401
{"userid":{"userid":123}} ->200
```

یک نسخه API قدیمی را آزمایش کنید

```
GET /v3/users_data/1234 ->401
GET /v1/users_data/1234 ->200
```

اگر وب سایت از graphql استفاده می کند، سعی کنید IDOR را با استفاده از graphql پیدا کنید!

```
GET /graphql
[...]

GET /graphql.php?query=
[...]
```