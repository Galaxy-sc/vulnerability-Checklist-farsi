# 2. Authentication

**Authentication Bypass**

موارد ابتدایی

بررسی کنید که آیا URL های  Authentication پست مستقیما در دسترس هستند و هیچ session ای به آن محدود نمی شود.

در صورتی که URL دزدیده/قابل حدس/بروت فورس شد, میتونه account takeover رخ بده

کپچا بایپس - X-Forwarded-For

با تزریق یک مقدار تصادفی در هدر “X-Forwarded-For” بررسی کپچا رو بایپس کنید

تایید نکردن پسورد

با این روش ها ازمایش کنید که ایا برای انجام کار مهمی در حساب کاربری تایید یا وارد کردن پسورد ضروری است:

تغییر ایمیل

تغییر رمز عبور

حذف حساب کاربری

مدیریت 2FA یا به قولی مدیریت 2 مرحله ای

نبود Rate Limiting در یک صفحه

یک صفحه از سایت در مرورگر باز کنید و ریکوئست را با پروکسی برپ سوییت intercept کنید
ریکوئست رو برای intruder بفرستید
ارسال همون ریکوئست رو 20-30 بار تکرار کنید
ببینید که تمامی این ریکوئست ها بدون محدودیت ارسال می شوند

بدون Rate Limiting یا Captcha در صفحه لاگین

به صفحه ورود برید و ریکوئست تلاش ناموفق برای ورود به سیستم (unsuccessful login) رو برای برپ سوییت Intruder ارسال کنید.

برای رمز عبور مقدار های تصادفی برای بروت فورس بزارید

ببینید که ریسپانس در 20 یا 30 امین ریکوئست تغییر نمیکنه و حساب کاربری قفل نمیشه

Username Email Address Enumeration

به صفحه ریست پسورد/ورود/ثبت نام یا هر قسمت دیگه ای که ورودی یوزرنیم یا ایمیل رو مگیره برید

برای یک یوزرنیم/ ایمیل موجود یک پسورد اشتباه بزنید که پیام خطا ببینید

برای دیدن پیام خطا، یوزرنیم/ ایمیل که در سایت میدونید وجود نداره رو بنویسید (مثلا دستتونو بکشید رو کیبرد =) )

ببینید که پیام خطا از موجود بودن یوزرنیم یا ایمیل اطلاعاتی بهتون میده مثلا بگه این پسورد اشتباه هست در صورتی که اگر درست مدیریت شده باشه باید بگه یوزرنیم و پسورد موجود نیست وقتی فقط میگه پسورد اشتباه هست یعنی احتمال 99 درصد اون یوزرنیم یا ایمیل موجود هست که میتونید با بروت فورس سعی به پیدا کردن پسوردش بکنید

Weak Password Policy

پسورد رو فقط عددی بکنید

پسورد رو فقط حروف کوچیک بکنید

پسوردهای رایج رو استفاده بکنید

پسورد کوتاه بزارید

ببینید که اپلیکیشن سیاست پسورد گزاریش ضعیف هست

 

Weak Registration Implementation over HTTP

موقع ثبت نام در اپلیکیشن ریکوئست رو داخل برپ Intercept کنید

ببینید که ریکوئست ثبت نام از طریق HTTP ارسال می شود

انتقال امن دیتا

جست و جو در صفحه لاگین

یک صفحه از سایت رو باز کنید و ریکوئست رو با برپ intercept کنید

ریکوئست رو با وایرشارک intercept کنید

مطمئن شوید که انتقال داده ها رمزگذاری شده است یا خیر

Username enumeration

استاتوس کد ها

ارور مسیج ها

میزان زمانی که برای برگردوندن ریسپانس طول میکشه

X-Forwarded-For

Broken Authentication Session Token Bug

یک حساب کاربری ایجاد کنید

ایمیل خودتونو تایید کنید

از حسابتون خارج بشید و ارسال کد بازیابی برای پسورد رو برای حساب خودتون بزنید

از کدی که به حساب ایمیلتون ارسال شده استفاده نکنید

در برگه جدید یا مرورگر جدید دوباره وارد حساب کاربری خودتون بشید

به تنظیمات حساب کاربریتون برید و پسوردتونو عوض کنید

حالا به ایمیل برید و کد بازیابی پسورد که در مرحله 3 درخواست کرده بودیم رو بررسی کنید

پسورد خودتونو با استفاده از کد بازیابی پسورد تغییر بدید

میبینید که پسوردتون عوض شده

Broken Authentication and Session Management

یک حساب کاربری با آدرس ایمیل "[a@x.com](mailto:a@x.com)" ایجاد کنید.

الان از حسابتون خارج بشید و لینک بازیابی پسورد رو بزنید. از لینک بازیابی پسورد ارسال شده به ایمیلتون استفاده نکنید

با استفاده از همون پسورد وارد حسابتون بشید و ایمیل خودتونو به "[b@x.com](mailto:b@x.com)" عوض کنید و تاییدش کنید "[a@x.com](mailto:a@x.com)" رو حذف کنید.

الان از حسابتون خارج بشید و از لینک بازیابی پسورد که در مرحله 2 به "[a@x.com](mailto:a@x.com)" ارسال شده استفاده کنید

پسورد تغییر خواهد کرد